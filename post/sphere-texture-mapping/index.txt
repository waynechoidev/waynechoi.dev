1:HL["/_next/static/css/baa01199c04a1a03.css","style",{"crossOrigin":""}]
0:["aqxnwij8molesiIkyFSsG",[[["",{"children":["post",{"children":[["slug","sphere-texture-mapping","d"],{"children":["__PAGE__?{\"slug\":\"sphere-texture-mapping\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/baa01199c04a1a03.css","precedence":"next","crossOrigin":""}]],"$L3"]]]]
4:HL["/_next/static/css/602feae4669a507e.css","style",{"crossOrigin":""}]
5:I[9194,["326","static/chunks/326-6784f49434136418.js","185","static/chunks/app/layout-21c5cbba278c1661.js"],""]
6:I[5629,["326","static/chunks/326-6784f49434136418.js","185","static/chunks/app/layout-21c5cbba278c1661.js"],""]
7:I[6954,[],""]
8:I[7264,[],""]
a:I[8326,["326","static/chunks/326-6784f49434136418.js","691","static/chunks/691-d72542b099e0bc41.js","605","static/chunks/app/post/%5Bslug%5D/page-c6220fba5b22e67b.js"],""]
b:I[7708,["326","static/chunks/326-6784f49434136418.js","691","static/chunks/691-d72542b099e0bc41.js","605","static/chunks/app/post/%5Bslug%5D/page-c6220fba5b22e67b.js"],""]
d:I[5631,["326","static/chunks/326-6784f49434136418.js","691","static/chunks/691-d72542b099e0bc41.js","605","static/chunks/app/post/%5Bslug%5D/page-c6220fba5b22e67b.js"],""]
3:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"WayneChoi.Dev"}],["$","meta","2",{"name":"description","content":"Wayne Choi blog"}],["$","meta","3",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","4",{"rel":"icon","href":"/favicon.ico"}]]
c:T1412,
> The code in this post is based on the lecture ,[Introduction to Computer Graphics with DirectX 11 - Part 2. Realtime Pipeline from Honglab](https://honglab.co.kr/courses/graphicspt2). I have adapted this example to OpenGL with some minor customizations in line with my own implementation approach.

<br/>

I want to map an Earth-like texture onto a spherical model. While the simplest method for mapping would be to use a cube map, creating an Earth-like texture as a cube map can be quite challenging. Due to the complexities involved in ensuring the cube map accurately represents the Earth's surface, it's often more suitable to explore alternative approaches.

---

## First attempt

At first, I began by generating the vertices of an tetrahedron model and performed multiple stages of triangle subdivision on the CPU to create a sphere model. Then, I attempted texture mapping on it, but it resulted in completely unexpected outcomes.

Upon inspecting the triangles with wireframe rendering, I noticed that starting the subdivision from a very simple model led to uneven triangles. This seemed to be the reason behind the unexpected results. For achieving more precise texturing, a more detailed modeling was necessary.

<img src="/img/sphere-texture-mapping-1.jpg" width="48%">
<img src="/img/sphere-texture-mapping-2.jpg" width="48%">

[Source code](https://github.com/waynechoidev/sphere-texture-mapping/tree/89d79e5aaefb43a9b0ffb79f4e000875797d440e)

---

## More detailed model

This time, I generated the vertices of a Icosahedron and applied subdivision before adding textures. I could confirm that this time, uniform triangles were formed as follows. However, there were still issues with the texture mapping. Strange lines appeared at the points where the texture started and ended.

<img src="/img/sphere-texture-mapping-3.jpg" width="48%">
<img src="/img/sphere-texture-mapping-4.jpg" width="48%">

Let's examine the image below. The long white vertical lines represent points where the texture meets at both the left and right ends. Point 'a' may appear as a single vertex, but it is, in fact, two separate vertices. One vertex is used to draw the left triangle, and the other vertex will be used to draw the right triangle. The texture coordinates will be (1.0, -) and (0.0, -) for each of them, and in this case, there won't be any issues with texturing.

However, for vertices 'b' and 'c,' the texture coordinates used to draw the middle triangle will be close to (1.0, -) and (0.0, -). As a result, the texture coordinate for point 'd' will be interpolated, leading to an entirely unexpected value like (0.5, -).

<img src="/img/sphere-texture-mapping-5.jpg" class="post-pic">

[Source code](https://github.com/waynechoidev/sphere-texture-mapping/tree/ae35dcc752c384a9a4354c8b2148dc0ca0f43cf7)

---

## Solution 1

If you model the sphere with a vertical-line structure from the beginning, instead of using a subdivision approach, you can avoid the issue of texture coordinates being interpolated as we discussed earlier. This way of modeling ensures consistent texture coordinates, allowing for the expected texture mapping at each point.

<img src="/img/sphere-texture-mapping-6.jpg" width="48%">
<img src="/img/sphere-texture-mapping-7.jpg" width="48%">

[Source code](https://github.com/waynechoidev/sphere-texture-mapping/tree/45a01ae9274993fcfcaf587b687a0da1e248567c)

---

## Solution 2

Another solution is to calculate texcoords at the pixel level in the shader, rather than at the vertex level. This method allows for more precise control over texture coordinates, enabling unique texture coordinates to be assigned to each pixel. It provides a way to accurately control how the texture should appear at specific points, resulting in different outcomes compared to subdivision-based or simple vertex-based texture coordinate allocation.

Using shaders to calculate texture coordinates at the pixel level can be complex, but it is highly beneficial for increasing the accuracy of texture mapping. It can be particularly effective when working with high-resolution textures or implementing special effects.

It is glsl codes to calculate texture coordinates.

```glsl
const float PI = 3.14159265359;

vec2 uv;
uv.x = 1.0 - (atan(posModel.z, posModel.x) / (PI * 2.0));
uv.y = acos(posModel.y / 1.5) / PI;
```

<iframe width="560" height="315" src="https://www.youtube.com/embed/mk4kBj-d8nU?si=CvjjIyaoAhZ_JL1u" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

[Source code](https://github.com/waynechoidev/sphere-texture-mapping)

---

### References

- [Introduction to Computer Graphics with DirectX 11 - Part 2. Realtime Pipeline](https://honglab.co.kr/courses/graphicspt2)
- [http://www.songho.ca/opengl/gl_sphere.html](http://www.songho.ca/opengl/gl_sphere.html)
- [https://mathworld.wolfram.com/RegularTetrahedron.html](https://mathworld.wolfram.com/RegularTetrahedron.html)
- [https://mathworld.wolfram.com/Isohedron.html](https://mathworld.wolfram.com/Isohedron.html)
2:[null,["$","html",null,{"lang":"en","children":["$","body",null,{"className":"mx-auto my-0","children":[["$","nav",null,{"className":"max-w-default mx-auto px-5 py-3","children":["$","$L5",null,{}]}],["$","header",null,{"children":["$","$L6",null,{}]}],["$","div",null,{"className":"max-w-default mx-auto p-5","children":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"childProp":{"current":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","post","children"],"loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":[null,["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","post","children",["slug","sphere-texture-mapping","d"],"children"],"loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L9",["$","div",null,{"children":[["$","$La",null,{"href":"/posts/graphics","className":"text-gray-600 text-md pl-1 hover:font-bold","children":"GRAPHICS"}],["$","h1",null,{"children":"Sphere texture mapping"}],["$","p",null,{"className":"text-gray-400 text-sm m-0 mt-1","children":"Oct 24, 2023"}],["$","div",null,{"className":"mt-1","children":["$","div",null,{"className":"whitespace-nowrap overflow-x-auto pb-3","children":[["$","$La","opengl",{"href":"/tag/opengl","className":"mr-2 text-gray-500 hover:font-bold","children":"#opengl"}],["$","$La","texture",{"href":"/tag/texture","className":"mr-2 text-gray-500 hover:font-bold","children":"#texture"}],["$","$La","cpp",{"href":"/tag/cpp","className":"mr-2 text-gray-500 hover:font-bold","children":"#cpp"}]]}]}],["$","div",null,{"className":"mt-8","children":["$","$Lb",null,{"content":"$c"}]}],["$","$Ld",null,{"issueTerm":"Sphere texture mapping"}]]}],null],"segment":"__PAGE__?{\"slug\":\"sphere-texture-mapping\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/602feae4669a507e.css","precedence":"next","crossOrigin":""}]]}],null],"segment":["slug","sphere-texture-mapping","d"]},"styles":[]}],"segment":"post"},"styles":[]}]}],["$","footer",null,{"className":"h-40 flex justify-center items-end","children":["$","p",null,{"className":"text-gray-500 text-sm","children":"(C) 2021. Wayne Choi. All rights reserved."}]}]]}]}],null]
9:null
