<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/c00f190515c854a4.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/602feae4669a507e.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-f301944bc72b7916.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-33f88dcb8cab817d.js" async="" crossorigin=""></script><script src="/_next/static/chunks/472-c5427e31248623a0.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-998ad79e34130139.js" async="" crossorigin=""></script><script src="/_next/static/chunks/326-6784f49434136418.js" async=""></script><script src="/_next/static/chunks/app/layout-2839943a160ba1e9.js" async=""></script><script src="/_next/static/chunks/691-d72542b099e0bc41.js" async=""></script><script src="/_next/static/chunks/app/post/%5Bslug%5D/page-8d1612d00a7872d1.js" async=""></script><title>WayneChoi.Dev</title><meta name="description" content="Wayne Choi blog"/><link rel="icon" href="/favicon.ico"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="mx-auto my-0"><nav class="max-w-default mx-auto px-5 py-3"><div class="flex justify-end"><a href="/about/"><span class="hover:font-bold pl-3 text-lg font-normal">About</span></a><a href="/posts/"><span class="hover:font-bold pl-3 text-lg font-normal">Posts</span></a></div></nav><header><div class="h-32 relative" id="sky"><canvas class="w-full h-full"></canvas><div class="absolute top-0 inset-x-auto w-full "><div class="w-full max-w-default mx-auto"><h1 class="text-4xl font-semibold p-5 pt-0"><a class="text-blue-800" href="/">WayneChoi.dev</a></h1></div></div></div></header><div class="max-w-default mx-auto p-5"><div><a class="text-gray-600 text-md pl-1 hover:font-bold" href="/posts/graphics/">GRAPHICS</a><h1>Sphere texture mapping</h1><p class="text-gray-400 text-sm m-0 mt-1">Oct 24, 2023</p><div class="mt-1"><div class="whitespace-nowrap overflow-x-auto pb-3"><a class="mr-2 text-gray-500 hover:font-bold" href="/tag/opengl/">#opengl</a><a class="mr-2 text-gray-500 hover:font-bold" href="/tag/texture/">#texture</a><a class="mr-2 text-gray-500 hover:font-bold" href="/tag/cpp/">#cpp</a></div></div><div class="mt-8"><div></div></div></div></div><footer class="h-40 flex justify-center items-end"><p class="text-gray-500 text-sm">(C) 2021. Wayne Choi. All rights reserved.</p></footer><script src="/_next/static/chunks/webpack-f301944bc72b7916.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/c00f190515c854a4.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/602feae4669a507e.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"4:I[3728,[],\"\"]\n6:I[9928,[],\"\"]\n7:I[9194,[\"326\",\"static/chunks/326-6784f49434136418.js\",\"185\",\"static/chunks/app/layout-2839943a160ba1e9.js\"],\"\"]\n8:I[5629,[\"326\",\"static/chunks/326-6784f49434136418.js\",\"185\",\"static/chunks/app/layout-2839943a160ba1e9.js\"],\"\"]\n9:I[6954,[],\"\"]\na:I[7264,[],\"\"]\nc:I[8326,[\"326\",\"static/chunks/326-6784f49434136418.js\",\"691\",\"static/chunks/691-d72542b099e0bc41.js\",\"605\",\"static/chunks/app/post/%5Bslug%5D/page-8d1612d00a7872d1.js\"],\"\"]\nd:I[7708,[\"326\",\"static/chunks/326-6784f494341"])</script><script>self.__next_f.push([1,"36418.js\",\"691\",\"static/chunks/691-d72542b099e0bc41.js\",\"605\",\"static/chunks/app/post/%5Bslug%5D/page-8d1612d00a7872d1.js\"],\"\"]\ne:T13ea,"])</script><script>self.__next_f.push([1,"\n\u003e The code in this post is based on the lecture 'Introduction to Computer Graphics with DirectX 11 - Part 3: Rendering Techniques' at Honglab. I have adapted this example to OpenGL with some minor customizations in line with my own implementation approach.\n\n\u003cbr/\u003e\n\nI want to map an Earth-like texture onto a spherical model. While the simplest method for mapping would be to use a cube map, creating an Earth-like texture as a cube map can be quite challenging. Due to the complexities involved in ensuring the cube map accurately represents the Earth's surface, it's often more suitable to explore alternative approaches.\n\n---\n\n## First attempt\n\nAt first, I began by generating the vertices of an tetrahedron model and performed multiple stages of triangle subdivision on the CPU to create a sphere model. Then, I attempted texture mapping on it, but it resulted in completely unexpected outcomes.\n\nUpon inspecting the triangles with wireframe rendering, I noticed that starting the subdivision from a very simple model led to uneven triangles. This seemed to be the reason behind the unexpected results. For achieving more precise texturing, a more detailed modeling was necessary.\n\n\u003cimg src=\"/img/sphere-texture-mapping-1.jpg\" width=\"48%\"\u003e\n\u003cimg src=\"/img/sphere-texture-mapping-2.jpg\" width=\"48%\"\u003e\n\n[Source code](https://github.com/waynechoidev/sphere-texture-mapping/tree/89d79e5aaefb43a9b0ffb79f4e000875797d440e)\n\n---\n\n## More detailed model\n\nThis time, I generated the vertices of a Icosahedron and applied subdivision before adding textures. I could confirm that this time, uniform triangles were formed as follows. However, there were still issues with the texture mapping. Strange lines appeared at the points where the texture started and ended.\n\n\u003cimg src=\"/img/sphere-texture-mapping-3.jpg\" width=\"48%\"\u003e\n\u003cimg src=\"/img/sphere-texture-mapping-4.jpg\" width=\"48%\"\u003e\n\nLet's examine the image below. The long white vertical lines represent points where the texture meets at both the left and right ends. Point 'a' may appear as a single vertex, but it is, in fact, two separate vertices. One vertex is used to draw the left triangle, and the other vertex will be used to draw the right triangle. The texture coordinates will be (1.0, -) and (0.0, -) for each of them, and in this case, there won't be any issues with texturing.\n\nHowever, for vertices 'b' and 'c,' the texture coordinates used to draw the middle triangle will be close to (1.0, -) and (0.0, -). As a result, the texture coordinate for point 'd' will be interpolated, leading to an entirely unexpected value like (0.5, -).\n\n\u003cimg src=\"/img/sphere-texture-mapping-5.jpg\" class=\"post-pic\"\u003e\n\n[Source code](https://github.com/waynechoidev/sphere-texture-mapping/tree/ae35dcc752c384a9a4354c8b2148dc0ca0f43cf7)\n\n---\n\n## Solution 1\n\nIf you model the sphere with a vertical-line structure from the beginning, instead of using a subdivision approach, you can avoid the issue of texture coordinates being interpolated as we discussed earlier. This way of modeling ensures consistent texture coordinates, allowing for the expected texture mapping at each point.\n\n\u003cimg src=\"/img/sphere-texture-mapping-6.jpg\" width=\"48%\"\u003e\n\u003cimg src=\"/img/sphere-texture-mapping-7.jpg\" width=\"48%\"\u003e\n\n[Source code](https://github.com/waynechoidev/sphere-texture-mapping/tree/45a01ae9274993fcfcaf587b687a0da1e248567c)\n\n---\n\n## Solution 2\n\nAnother solution is to calculate texcoords at the pixel level in the shader, rather than at the vertex level. This method allows for more precise control over texture coordinates, enabling unique texture coordinates to be assigned to each pixel. It provides a way to accurately control how the texture should appear at specific points, resulting in different outcomes compared to subdivision-based or simple vertex-based texture coordinate allocation.\n\nUsing shaders to calculate texture coordinates at the pixel level can be complex, but it is highly beneficial for increasing the accuracy of texture mapping. It can be particularly effective when working with high-resolution textures or implementing special effects.\n\nIt is glsl codes to calculate texture coordinates.\n\n```glsl\nconst float PI = 3.14159265359;\n\nvec2 uv;\nuv.x = 1.0 - (atan(posModel.z, posModel.x) / (PI * 2.0));\nuv.y = acos(posModel.y / 1.5) / PI;\n```\n\n\u003ciframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/mk4kBj-d8nU?si=CvjjIyaoAhZ_JL1u\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen\u003e\u003c/iframe\u003e\n\n[Source code](https://github.com/waynechoidev/sphere-texture-mapping)\n\n---\n\n### References\n\n- [Introduction to Computer Graphics with DirectX 11 - Part 3. Rendering Techniques](https://honglab.co.kr/courses/graphicspt3)\n- [http://www.songho.ca/opengl/gl_sphere.html](http://www.songho.ca/opengl/gl_sphere.html)\n- [https://mathworld.wolfram.com/RegularTetrahedron.html](https://mathworld.wolfram.com/RegularTetrahedron.html)\n- [https://mathworld.wolfram.com/Isohedron.html](https://mathworld.wolfram.com/Isohedron.html)\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c00f190515c854a4.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"PDGEfqxxlyxcS-DtWLNn_\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/post/sphere-texture-mapping/\",\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"slug\",\"sphere-texture-mapping\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"sphere-texture-mapping\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L5\"],\"globalErrorComponent\":\"$6\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"mx-auto my-0\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"max-w-default mx-auto px-5 py-3\",\"children\":[\"$\",\"$L7\",null,{}]}],[\"$\",\"header\",null,{\"children\":[\"$\",\"$L8\",null,{}]}],[\"$\",\"div\",null,{\"className\":\"max-w-default mx-auto p-5\",\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[null,[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",[\"slug\",\"sphere-texture-mapping\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Lb\",[\"$\",\"div\",null,{\"children\":[[\"$\",\"$Lc\",null,{\"href\":\"/posts/graphics\",\"className\":\"text-gray-600 text-md pl-1 hover:font-bold\",\"children\":\"GRAPHICS\"}],[\"$\",\"h1\",null,{\"children\":\"Sphere texture mapping\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-400 text-sm m-0 mt-1\",\"children\":\"Oct 24, 2023\"}],[\"$\",\"div\",null,{\"className\":\"mt-1\",\"children\":[\"$\",\"div\",null,{\"className\":\"whitespace-nowrap overflow-x-auto pb-3\",\"children\":[[\"$\",\"$Lc\",\"opengl\",{\"href\":\"/tag/opengl\",\"className\":\"mr-2 text-gray-500 hover:font-bold\",\"children\":\"#opengl\"}],[\"$\",\"$Lc\",\"texture\",{\"href\":\"/tag/texture\",\"className\":\"mr-2 text-gray-500 hover:font-bold\",\"children\":\"#texture\"}],[\"$\",\"$Lc\",\"cpp\",{\"href\":\"/tag/cpp\",\"className\":\"mr-2 text-gray-500 hover:font-bold\",\"children\":\"#cpp\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"mt-8\",\"children\":[\"$\",\"$Ld\",null,{\"content\":\"$e\"}]}]]}],null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"sphere-texture-mapping\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/602feae4669a507e.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}],null],\"segment\":[\"slug\",\"sphere-texture-mapping\",\"d\"]},\"styles\":[]}],\"segment\":\"post\"},\"styles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"h-40 flex justify-center items-end\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-gray-500 text-sm\",\"children\":\"(C) 2021. Wayne Choi. All rights reserved.\"}]}]]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"WayneChoi.Dev\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Wayne Choi blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}]]\nb:null\n"])</script></body></html>